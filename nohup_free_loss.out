[2025-12-20 11:19:59,471] INFO:ptp_discovery.free_loss_eoh: Starting free loss EoH search with config=configs/free_loss_discovery.yaml
[2025-12-20 11:20:02,473] INFO:ptp_discovery.free_loss_eoh: Baseline PO training: steps=15630, train_problem_size=100, pomo_size=100, batch_size=64, device=cuda, init_time=1.875s
[2025-12-20 11:20:04,140] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1/15630: score=48.226318 (avg=48.226318), loss=0.356016 (avg=0.356016)
[2025-12-20 11:20:38,233] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 11:24:51,465] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 781/15630: score=8.251265 (avg=8.626939), loss=0.309755 (avg=0.302814)
[2025-12-20 11:29:19,250] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1562/15630: score=8.054039 (avg=8.387475), loss=0.312236 (avg=0.306795)
[2025-12-20 11:29:19,589] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 11:29:38,624] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 1/10: validation_objective=8.024135
[2025-12-20 11:34:06,506] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 2343/15630: score=8.102322 (avg=8.287024), loss=0.315917 (avg=0.309381)
[2025-12-20 11:38:34,489] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 3124/15630: score=8.058609 (avg=8.229138), loss=0.315736 (avg=0.311105)
[2025-12-20 11:38:35,166] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 11:38:54,193] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 2/10: validation_objective=7.987586
[2025-12-20 11:43:21,293] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 3905/15630: score=7.999727 (avg=8.190165), loss=0.319373 (avg=0.312389)
[2025-12-20 11:47:40,900] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 4686/15630: score=7.976952 (avg=8.161794), loss=0.318694 (avg=0.313411)
[2025-12-20 11:47:41,911] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 11:48:00,575] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 3/10: validation_objective=7.966661
[2025-12-20 11:52:20,670] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 5467/15630: score=7.978719 (avg=8.139269), loss=0.320983 (avg=0.314301)
[2025-12-20 11:56:39,606] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 6248/15630: score=7.992542 (avg=8.121109), loss=0.320116 (avg=0.315140)
[2025-12-20 11:56:40,947] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 11:56:59,651] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 4/10: validation_objective=7.953242
[2025-12-20 12:01:17,834] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 7029/15630: score=7.972173 (avg=8.105744), loss=0.321805 (avg=0.315918)
[2025-12-20 12:05:37,302] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 7810/15630: score=7.901186 (avg=8.092346), loss=0.321184 (avg=0.316591)
[2025-12-20 12:05:38,974] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:05:57,786] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 5/10: validation_objective=7.930438
[2025-12-20 12:10:17,858] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 8591/15630: score=7.995430 (avg=8.080771), loss=0.323508 (avg=0.317212)
[2025-12-20 12:14:44,784] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 9372/15630: score=7.958495 (avg=8.070258), loss=0.324002 (avg=0.317769)
[2025-12-20 12:14:46,821] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:15:05,835] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 6/10: validation_objective=7.920151
[2025-12-20 12:19:29,505] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 10153/15630: score=7.956890 (avg=8.060829), loss=0.326654 (avg=0.318252)
[2025-12-20 12:23:57,310] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 10934/15630: score=7.961530 (avg=8.052339), loss=0.326092 (avg=0.318709)
[2025-12-20 12:23:59,679] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:24:18,494] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 7/10: validation_objective=7.920460
[2025-12-20 12:28:43,701] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 11715/15630: score=7.918846 (avg=8.044354), loss=0.325530 (avg=0.319126)
[2025-12-20 12:33:12,005] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 12496/15630: score=7.936357 (avg=8.037253), loss=0.324179 (avg=0.319512)
[2025-12-20 12:33:14,769] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:33:34,191] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 8/10: validation_objective=7.909283
[2025-12-20 12:37:59,658] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 13277/15630: score=7.880301 (avg=8.030571), loss=0.325490 (avg=0.319868)
[2025-12-20 12:42:20,728] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 14058/15630: score=7.912438 (avg=8.024462), loss=0.324735 (avg=0.320202)
[2025-12-20 12:42:23,657] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:42:42,711] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 9/10: validation_objective=7.900317
[2025-12-20 12:47:06,417] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 14839/15630: score=7.879457 (avg=8.018681), loss=0.326684 (avg=0.320519)
[2025-12-20 12:51:36,797] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 15620/15630: score=7.940520 (avg=8.013157), loss=0.326289 (avg=0.320816)
[2025-12-20 12:51:40,222] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:51:59,147] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 10/10: validation_objective=7.893047
[2025-12-20 12:51:59,147] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:52:18,092] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-20 12:52:37,022] INFO:ptp_discovery.free_loss_eoh: Baseline PO timing: init=1.875s, train=5516.674s, eval=37.875s
[2025-12-20 12:52:37,024] INFO:ptp_discovery.free_loss_eoh: Baseline po_loss: hf_score=7.894756, fitness_score=7.940532, validation_objective=7.894756, gen_penalty=0.000000
[2025-12-20 12:52:37,024] INFO:ptp_discovery.free_loss_eoh: Run directory: /data1/gushengda/PTP/runs/free_loss_discovery/20251220-125237
[2025-12-20 12:52:37,025] INFO:ptp_discovery.free_loss_eoh: === Generation 0/9 ===
[2025-12-20 12:52:37,025] INFO:ptp_discovery.free_loss_eoh: Generating initial population with 8 LLM candidates
[2025-12-20 12:52:51,197] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:53:04,973] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:53:17,114] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:53:28,308] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:53:42,312] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:53:53,826] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:54:08,588] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:54:20,192] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:54:38,989] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:54:54,339] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:55:09,919] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:55:22,759] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:55:37,842] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:55:50,442] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:56:04,454] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:56:16,327] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:56:16,330] INFO:ptp_discovery.free_loss_eoh: Population size for generation 0: 8
[2025-12-20 12:56:26,089] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:56:26,091] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `batch` dictionary should contain `log_prob_l` (log probability of the preferred item), `log_prob_w` (log probability of the dispreferred item), `cost_a`, `cost_b`, and optional `weight`. The `extra` dictionary should contain the hyperparameter `alpha`.'
[2025-12-20 12:56:26,099] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=0, name=Sigmoid_Margin_Rank_Loss: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:56:36,652] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:56:36,660] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=0, name=Sigmoid_Margin_Rank_Loss: reason=forward_error: 'cost_l', loss_value=None, grad_norm=None
[2025-12-20 12:57:02,733] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:57:02,745] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=1, name=Adaptive Sigmoid Margin Loss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'torch' and 'F', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:57:13,072] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:57:13,084] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=1, name=Adaptive Sigmoid Margin Loss: reason=forward_error: 'torch', loss_value=None, grad_norm=None
[2025-12-20 12:57:22,812] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:57:22,814] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'."
[2025-12-20 12:57:22,824] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=2, name=AdaptiveSigmoidMarginLoss: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:57:33,469] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:57:33,481] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=2, name=AdaptiveSigmoidMarginLoss: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None
[2025-12-20 12:57:47,558] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:57:47,570] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=3, name=Sigmoid-Weighted Margin Loss: reason=forward_error: 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:58:00,907] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:58:00,910] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch of paired samples, where each sample contains `cost_a`, `cost_b`, `log_prob_w` (log prob of solution 'a'), `log_prob_l` (log prob of solution 'b'). The `ops` object provides `sigmoid` and `softplus` functions. The `extra` dict contains hyperparameters."
[2025-12-20 12:58:00,918] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=3, name=Sigmoid-Weighted Margin Loss: reason=forward_error: generated_loss() missing 1 required positional argument: 'extra', loss_value=None, grad_norm=None
[2025-12-20 12:58:15,657] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:58:15,660] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="The `batch` dict should contain `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`. The `extra` dict should contain `alpha` and `gamma` hyperparameters. The `log_prob_w` and `log_prob_l` fields are placeholders and will be populated with the model's log-probabilities for the corresponding solutions in the pair (e.g., `a` and `b`)."
[2025-12-20 12:58:15,670] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=4, name=AdaptiveSigmoidFocalLoss: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:58:28,527] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:58:28,530] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'. An extra dictionary with 'alpha' and 'gamma'."
[2025-12-20 12:58:28,539] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=4, name=AdaptiveSigmoidFocalLoss: reason=forward_error: name 'len' is not defined, loss_value=None, grad_norm=None
[2025-12-20 12:58:40,391] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:58:40,394] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A `batch` dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'. 'log_prob_w' is the log probability of the chosen response and 'log_prob_l' is the log probability of the rejected response. 'cost_a' and 'cost_b' are scalar costs where lower is better. An `extra` dictionary containing hyperparameters 'margin_scale', 'focal_gamma', and 'logit_clip'."
[2025-12-20 12:58:40,404] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=5, name=AdaptiveSigmoidFocalLoss: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:58:54,451] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:58:54,463] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=5, name=AdaptiveSigmoidFocalLoss: reason=forward_error: 'operators', loss_value=None, grad_norm=None
[2025-12-20 12:59:05,476] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:59:05,478] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A dictionary `batch` with keys `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight`. `log_prob_w` corresponds to the preferred sequence (assumed to be sequence 'a'), and `log_prob_l` to the dispreferred one (sequence 'b')."
[2025-12-20 12:59:05,487] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=6, name=SoftHingeFocalLoss: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:59:17,849] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:59:17,852] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="The `batch` dict should contain `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`. `cost_a` < `cost_b` is assumed, representing winner and loser costs respectively. `log_prob_w` and `log_prob_l` are the model's log probabilities for the chosen and rejected responses."
[2025-12-20 12:59:17,859] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=6, name=SoftHingeFocalLoss: reason=forward_error: 'ops', loss_value=None, grad_norm=None
[2025-12-20 12:59:29,637] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:59:29,646] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=7, name=Sigmoid-Weighted Margin Loss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'torch', 'F', and 'zscore', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 12:59:42,388] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 12:59:42,390] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `batch` dict should contain `cost_a`, `cost_b`, `log_prob_w`, and `log_prob_l`. `cost_a` corresponds to the preferred item (`w`), and `cost_b` to the unpreferred item (`l`). By convention, `cost_a < cost_b`.'
[2025-12-20 12:59:42,398] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=7, name=Sigmoid-Weighted Margin Loss: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None
[2025-12-20 12:59:42,398] INFO:ptp_discovery.free_loss_eoh: Generation 0 summary: static_fail=0, dynamic_fail=8, evaluated=0, new_elites=0
[2025-12-20 12:59:42,398] INFO:ptp_discovery.free_loss_eoh: === Generation 1/9 ===
[2025-12-20 12:59:42,398] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=0
[2025-12-20 12:59:58,148] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:00:10,949] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:00:24,387] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:00:35,101] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:00:50,609] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:01:03,065] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:01:16,594] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:01:27,810] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:01:43,078] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:01:57,390] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:02:12,237] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:02:23,168] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:02:34,817] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:02:44,640] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:03:00,794] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:03:13,687] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:03:13,690] INFO:ptp_discovery.free_loss_eoh: Population size for generation 1: 8
[2025-12-20 13:03:26,225] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:03:26,228] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and an `extra` dictionary with `hyperparams`. `log_prob_w` corresponds to the preferred item `a`.'
[2025-12-20 13:03:35,177] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:03:35,179] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary containing `cost_w`, `cost_l`, `log_prob_w`, `log_prob_l` tensors. `cost_w` should be less than `cost_l`.'
[2025-12-20 13:03:35,189] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=1, name=AdaptiveMarginHingeLoss: reason=forward_error: 'cost_w', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 13:03:43,833] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:03:43,835] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of preference pairs (a, b) where a is preferred over b (cost_a < cost_b). The batch should contain `cost_a`, `cost_b`, `log_prob_a`, `log_prob_b`.'
[2025-12-20 13:03:43,845] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=1, name=AdaptiveMarginHingeLoss: reason=forward_error: 'log_prob_a', loss_value=None, grad_norm=None
[2025-12-20 13:03:56,644] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:03:56,648] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="The `batch` dictionary is expected to contain `cost_a`, `cost_b`, `log_prob_w`, and `log_prob_l`. `cost_a` is assumed to be less than `cost_b`, making 'a' the winner ('w') and 'b' the loser ('l'). The `extra` dictionary contains hyperparameters `beta` and `gamma`."
[2025-12-20 13:04:06,858] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:04:06,861] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight`. `cost_a` and `log_prob_w` correspond to the 'winner' of the pair."
[2025-12-20 13:04:19,862] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:04:19,865] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `batch` dictionary is expected to contain `cost_a`, `cost_b` (float tensors), and optionally `weight` (float tensor). The `model_output` dictionary is expected to contain `log_prob_a` and `log_prob_b` (float tensors representing log probabilities).'
[2025-12-20 13:04:19,875] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=4, name=AdaptiveSigmoidFocalLoss: reason=forward_error: 'log_prob_a', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 13:04:31,932] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:04:31,935] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='`batch` with `cost_a` and `cost_b`, and `model_output` with `logits_a` and `logits_b`.'
[2025-12-20 13:04:31,948] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=4, name=AdaptiveSigmoidFocalLoss: reason=forward_error: 'logits_a', loss_value=None, grad_norm=None
[2025-12-20 13:04:44,152] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:04:54,393] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:05:05,648] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:05:17,337] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:05:17,340] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `batch` dictionary should contain `cost_a` and `cost_b` tensors. The `model_output` dictionary should contain `log_prob_a` and `log_prob_b` tensors.'
[2025-12-20 13:05:17,348] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=7, name=AdaptiveSigmoidFocalLoss: reason=forward_error: generated_loss() missing 1 required positional argument: 'torch', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 13:05:29,101] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 13:05:29,104] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='This loss expects `log_prob_a` and `log_prob_b` from the model output, and `cost_a` and `cost_b` from the batch, where a lower cost is better. It can also use optional `weight` per sample from the batch.'
[2025-12-20 13:05:29,113] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=7, name=AdaptiveSigmoidFocalLoss: reason=forward_error: 'torch', loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=9152 device=cuda:1 jobs=[(1, 2)]
[free_loss_eoh][device_worker] pid=9153 device=cuda:2 jobs=[(1, 3)]
[free_loss_eoh][device_worker] pid=9151 device=cuda:0 jobs=[(1, 0), (1, 6)]
[free_loss_eoh][device_worker] pid=9154 device=cuda:3 jobs=[(1, 5)]
[2025-12-20 14:38:44,139] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 0: hf_like_score=33.584447, validation_objective=23.584447, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:38:44,140] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 2: hf_like_score=28.911475, validation_objective=18.911475, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:38:44,140] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 3: hf_like_score=33.395939, validation_objective=23.395939, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:38:44,140] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 5: hf_like_score=29.580309, validation_objective=19.580309, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:38:44,140] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 6: hf_like_score=18.453223, validation_objective=8.458880, epoch_mean=8.451072, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:38:44,141] INFO:ptp_discovery.free_loss_eoh: Generation 1 summary: static_fail=0, dynamic_fail=3, evaluated=5, new_elites=5
[2025-12-20 14:38:44,141] INFO:ptp_discovery.free_loss_eoh: === Generation 2/9 ===
[2025-12-20 14:38:44,141] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 14:39:00,106] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:39:13,838] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:39:29,633] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:39:42,254] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:39:57,476] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:40:09,177] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:40:25,807] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:40:39,541] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:40:54,777] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:41:07,977] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:41:23,964] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:41:34,746] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:41:52,487] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:42:05,453] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:42:21,207] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:42:35,185] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:42:35,188] INFO:ptp_discovery.free_loss_eoh: Population size for generation 2: 8
[2025-12-20 14:42:35,225] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=6, name=FocalHingeSigmoidLoss: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=1/2)
[2025-12-20 14:42:47,536] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:42:47,539] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary containing `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors.'
[free_loss_eoh][device_worker] pid=56740 device=cuda:2 jobs=[(2, 2), (2, 6)]
[free_loss_eoh][device_worker] pid=56738 device=cuda:0 jobs=[(2, 0), (2, 4)]
[free_loss_eoh][device_worker] pid=56739 device=cuda:1 jobs=[(2, 1), (2, 5)]
[free_loss_eoh][device_worker] pid=56741 device=cuda:3 jobs=[(2, 3), (2, 7)]
[2025-12-20 14:45:16,891] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 0: hf_like_score=21.217671, validation_objective=11.217671, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,891] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 1: hf_like_score=33.313040, validation_objective=23.313040, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,891] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 2: hf_like_score=32.831573, validation_objective=22.831573, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,892] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 3: hf_like_score=18.493369, validation_objective=8.493369, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,892] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 4: hf_like_score=33.164187, validation_objective=23.164187, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,892] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 5: hf_like_score=34.259221, validation_objective=24.259221, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,892] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 6: hf_like_score=19.565496, validation_objective=9.565496, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,892] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 7: hf_like_score=80.937774, validation_objective=70.896715, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 14:45:16,892] INFO:ptp_discovery.free_loss_eoh: Generation 2 summary: static_fail=0, dynamic_fail=0, evaluated=8, new_elites=8
[2025-12-20 14:45:16,893] INFO:ptp_discovery.free_loss_eoh: === Generation 3/9 ===
[2025-12-20 14:45:16,893] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 14:45:34,805] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:45:50,186] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:46:08,333] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:46:22,190] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:46:38,748] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:46:52,870] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:47:09,985] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:47:25,821] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:47:42,656] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:47:56,968] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:48:16,849] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:48:32,549] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:48:49,265] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:49:03,253] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:49:22,107] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:49:37,824] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:49:37,828] INFO:ptp_discovery.free_loss_eoh: Population size for generation 3: 8
[2025-12-20 14:49:49,360] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:49:49,362] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A dictionary `batch` with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optionally 'weight'. An `extra` dictionary with an optional 'hyperparams' dictionary."
[2025-12-20 14:49:49,370] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=0, name=AdaptiveFocalBradleyTerryLoss: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 14:50:02,592] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:50:02,594] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` containing `log_prob_w` (log-probabilities of winners), `log_prob_l` (log-probabilities of losers), `cost_a` (costs of winners), and `cost_b` (costs of losers). All are 1D tensors of the same shape. An optional `weight` tensor may also be present.'
[2025-12-20 14:50:02,606] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=0, name=AdaptiveFocalBradleyTerryLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None
[2025-12-20 14:50:13,883] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:50:13,886] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="The loss function `generated_loss` expects `batch` (a dict with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'), `model_output`, and `extra` (a dict with 'hyperparams'). It assumes the `torch` module and operators like `logsigmoid`, `sigmoid`, etc., are available in its execution scope."
[2025-12-20 14:50:13,895] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=1, name=NormalizedFocalBradleyTerry: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 14:50:26,473] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:50:26,662] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='PyTorch tensors `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b` of shape `(batch_size,)`.'
[2025-12-20 14:50:43,487] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:50:43,490] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `batch` dictionary should contain `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight` tensors. The `extra` dictionary should contain `hyperparams` with `gamma` and `epsilon` values.'
[2025-12-20 14:50:43,502] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=2, name=NormalizedFocalBradleyTerry: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 14:50:56,097] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:50:56,099] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `batch` dictionary should contain `cost_a`, `cost_b`, `log_prob_w` (for winner `a`), and `log_prob_l` (for loser `b`). It can optionally contain a `weight` tensor. `log_prob_w` and `log_prob_l` are log-probabilities of the chosen sequences.'
[2025-12-20 14:50:56,107] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=2, name=NormalizedFocalBradleyTerry: reason=forward_error: name 'log' is not defined, loss_value=None, grad_norm=None
[2025-12-20 14:51:08,225] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:51:08,228] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='This loss function expects a batch containing `cost_a`, `cost_b`, `log_prob_w` (for winner a), `log_prob_l` (for loser b), and optionally `weight` for each pair. `cost_a` and `cost_b` are scalar costs, and `log_prob_w` and `log_prob_l` are the log probabilities of the model generating the respective sequences.'
[2025-12-20 14:51:19,814] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:51:19,816] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b' (scalars), 'log_prob_w', 'log_prob_l' (log-probabilities of winning and losing responses), and optional 'weight'."
[2025-12-20 14:51:19,829] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=4, name=NormalizedFocalBradleyTerry: reason=forward_error: 'zscore', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 14:51:31,257] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:51:31,259] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch of contrastive preference pairs (a, b) where 'a' is preferred over 'b', with their associated costs and log probabilities from the model."
[2025-12-20 14:51:31,267] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=4, name=NormalizedFocalBradleyTerry: reason=forward_error: generated_loss() missing 5 required positional arguments: 'log', 'sigmoid', 'tanh', 'logsigmoid', and 'zscore', loss_value=None, grad_norm=None
[2025-12-20 14:51:43,935] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:51:43,938] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A `batch` dictionary with keys `'cost_a'`, `'cost_b'`, `'log_prob_w'`, `'log_prob_l'`, and optionally `'weight'`. The `extra` dictionary contains `hyperparams`."
[2025-12-20 14:51:43,946] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=5, name=NormalizedFocalBradleyTerryLoss: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 14:51:56,182] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:51:56,185] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'."
[2025-12-20 14:52:08,152] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:52:08,155] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A `batch` dictionary with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors.'
[2025-12-20 14:52:21,392] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:52:21,405] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=7, name=NormalizedFocalBradleyTerryLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 14:52:33,594] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 14:52:33,597] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l' tensors. An 'extra' dictionary containing 'hyperparams' and a library of operators 'ops'."
[2025-12-20 14:52:33,605] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=7, name=NormalizedFocalBradleyTerryLoss: reason=forward_error: 'ops', loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=61736 device=cuda:0 jobs=[(3, 3)]
[free_loss_eoh][device_worker] pid=61737 device=cuda:1 jobs=[(3, 5)]
[free_loss_eoh][device_worker] pid=61738 device=cuda:2 jobs=[(3, 6)]
[2025-12-20 16:24:20,631] INFO:ptp_discovery.free_loss_eoh: Gen 3 cand 3: hf_like_score=18.196041, validation_objective=8.230753, epoch_mean=8.196041, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 16:24:20,631] INFO:ptp_discovery.free_loss_eoh: Gen 3 cand 5: hf_like_score=18.512681, validation_objective=8.512681, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 16:24:20,631] INFO:ptp_discovery.free_loss_eoh: Gen 3 cand 6: hf_like_score=18.861407, validation_objective=8.861407, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 16:24:20,631] INFO:ptp_discovery.free_loss_eoh: Generation 3 summary: static_fail=0, dynamic_fail=4, evaluated=3, new_elites=3
[2025-12-20 16:24:20,632] INFO:ptp_discovery.free_loss_eoh: === Generation 4/9 ===
[2025-12-20 16:24:20,632] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 16:24:34,389] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:24:45,749] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:25:00,292] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:25:12,553] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:25:28,558] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:25:40,687] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:25:53,690] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:26:04,840] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:26:18,397] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:26:30,087] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:26:44,902] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:26:55,502] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:27:09,616] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:27:21,652] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:27:38,337] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:27:53,224] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:27:53,226] INFO:ptp_discovery.free_loss_eoh: Population size for generation 4: 8
[2025-12-20 16:28:03,674] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:28:03,677] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of contrastive examples with `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optional `weight` fields. Also expects `hyperparams` in the `extra` dictionary.'
[2025-12-20 16:28:03,684] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=0, name=SoftHingeFocalLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'torch' and 'F', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 16:28:14,049] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:28:14,051] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'."
[2025-12-20 16:28:25,351] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:28:25,353] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of paired samples `(a, b)` with `cost_a`, `cost_b`, `log_prob_w` (for a), and `log_prob_l` (for b).'
[2025-12-20 16:28:25,363] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=1, name=AdaptiveFocalHingeLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 16:28:36,377] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:28:36,380] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` containing `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and an optional `weight`. An `operators` object with methods for `sigmoid`, `tanh`, and `relu`.'
[2025-12-20 16:28:36,392] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=1, name=AdaptiveFocalHingeLoss: reason=forward_error: 'operators', loss_value=None, grad_norm=None
[2025-12-20 16:28:47,194] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:28:47,196] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch object with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'. 'log_prob_w' and 'log_prob_l' are the log probabilities of the winning and losing responses, respectively. An optional 'weight' key can be provided for weighted loss calculation."
[2025-12-20 16:28:57,689] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:28:57,695] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch containing `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optional `weight` tensors.'
[2025-12-20 16:29:08,372] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:29:08,374] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of paired data with fields `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l` and optional `weight`.'
[2025-12-20 16:29:19,309] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:29:19,311] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'."
[2025-12-20 16:29:30,656] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:29:30,658] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='PyTorch tensors `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optional `weight`.'
[2025-12-20 16:29:30,668] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=7, name=ClippedFocalMarginLoss: reason=forward_error: 'ops', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 16:29:42,328] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 16:29:42,331] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A dictionary `batch` with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'. An `ops` object for numerical operations. An `extra` dictionary containing `hyperparams`."
[2025-12-20 16:29:42,340] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=7, name=ClippedFocalMarginLoss: reason=forward_error: generated_loss() missing 1 required positional argument: 'extra', loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=108260 device=cuda:2 jobs=[(4, 4)]
[free_loss_eoh][device_worker] pid=108259 device=cuda:1 jobs=[(4, 3)]
[free_loss_eoh][device_worker] pid=108261 device=cuda:3 jobs=[(4, 5)]
[free_loss_eoh][device_worker] pid=108258 device=cuda:0 jobs=[(4, 2), (4, 6)]
[2025-12-20 18:02:39,045] INFO:ptp_discovery.free_loss_eoh: Gen 4 cand 2: hf_like_score=33.451012, validation_objective=23.451012, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:02:39,045] INFO:ptp_discovery.free_loss_eoh: Gen 4 cand 3: hf_like_score=18.784829, validation_objective=8.711380, epoch_mean=8.784152, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:02:39,045] INFO:ptp_discovery.free_loss_eoh: Gen 4 cand 4: hf_like_score=18.572709, validation_objective=8.585980, epoch_mean=8.572709, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:02:39,046] INFO:ptp_discovery.free_loss_eoh: Gen 4 cand 5: hf_like_score=18.826156, validation_objective=8.872033, epoch_mean=8.823797, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:02:39,046] INFO:ptp_discovery.free_loss_eoh: Gen 4 cand 6: hf_like_score=84.648064, validation_objective=74.648064, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:02:39,046] INFO:ptp_discovery.free_loss_eoh: Generation 4 summary: static_fail=0, dynamic_fail=2, evaluated=5, new_elites=5
[2025-12-20 18:02:39,046] INFO:ptp_discovery.free_loss_eoh: === Generation 5/9 ===
[2025-12-20 18:02:39,046] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 18:02:52,580] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:03:04,338] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:03:18,960] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:03:32,336] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:03:48,346] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:03:59,907] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:04:13,672] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:04:24,596] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:04:39,614] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:04:52,666] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:05:06,140] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:05:18,411] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:05:31,874] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:05:43,218] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:05:57,698] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:06:10,027] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:06:10,030] INFO:ptp_discovery.free_loss_eoh: Population size for generation 5: 8
[2025-12-20 18:06:21,306] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:06:21,308] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A `batch` dict with `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and an optional `weight` tensor. An `extra` dict with a `hyperparams` dict containing `alpha` and `gamma`.'
[2025-12-20 18:06:21,317] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=0, name=FocalSigmoidMarginLoss: reason=forward_error: generated_loss() missing 1 required positional argument: 'torch', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:06:32,728] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:06:32,731] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch of pairs (a, b) where 'a' is preferred to 'b'. Each pair must have 'log_prob_w', 'log_prob_l', 'cost_a', and 'cost_b'."
[2025-12-20 18:06:32,740] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=0, name=FocalSigmoidMarginLoss: reason=forward_error: generated_loss() missing 1 required positional argument: 'torch', loss_value=None, grad_norm=None
[2025-12-20 18:06:44,599] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:06:44,602] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary containing `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight`.'
[2025-12-20 18:06:55,941] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:06:55,945] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight' tensors."
[2025-12-20 18:06:55,953] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=2, name=FocalHingeBradleyTerryLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'torch' and 'F', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:07:06,621] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:07:06,623] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'. 'log_prob_w' and 'log_prob_l' are the log probabilities of the winning and losing sequences, respectively."
[2025-12-20 18:07:17,566] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:07:27,512] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:07:27,514] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of paired samples (a, b) where a is preferred over b. Each sample includes `log_prob_w` (log-probability of the winning response), `log_prob_l` (log-probability of the losing response), `cost_a` (cost of the winning response), and `cost_b` (cost of the losing response). An optional `weight` tensor for each pair can also be provided.'
[2025-12-20 18:07:27,525] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=3, name=FocalClippedMarginLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None
[2025-12-20 18:07:36,502] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:07:36,504] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A `batch` dict with `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`. Logits are log-probabilities.'
[2025-12-20 18:07:48,547] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:07:48,549] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch of paired samples, where each sample contains the log-probabilities (`log_prob_w`, `log_prob_l`) and costs (`cost_a`, `cost_b`) for a preferred ('a') and unpreferred ('b') completion."
[2025-12-20 18:07:48,561] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=5, name=FocalHingeLogLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:07:59,844] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:07:59,846] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `extra` dictionary must contain an `operators` sub-dictionary with callables for `sigmoid`, `tanh`, `log`, and `relu`.'
[2025-12-20 18:07:59,854] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=5, name=FocalHingeLogLoss: reason=forward_error: 'operators', loss_value=None, grad_norm=None
[2025-12-20 18:08:10,258] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:08:10,266] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A `batch` dict with `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optionally `weight`. `model_output` and `extra` are also provided.'
[2025-12-20 18:08:21,431] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:08:21,433] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` containing `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l` and optional `weight` tensors.'
[2025-12-20 18:08:21,442] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=7, name=FocalHingeBradleyTerryHybrid: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:08:33,249] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:08:33,251] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'. An `extra` object containing `hyperparams` and an `ops` object with whitelisted operators."
[2025-12-20 18:08:33,260] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=7, name=FocalHingeBradleyTerryHybrid: reason=forward_error: 'ops', loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=169515 device=cuda:2 jobs=[(5, 6)]
[free_loss_eoh][device_worker] pid=169513 device=cuda:0 jobs=[(5, 1)]
[free_loss_eoh][device_worker] pid=169514 device=cuda:1 jobs=[(5, 4)]
[2025-12-20 18:09:51,097] INFO:ptp_discovery.free_loss_eoh: Gen 5 cand 1: hf_like_score=32.793464, validation_objective=22.793464, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:09:51,097] INFO:ptp_discovery.free_loss_eoh: Gen 5 cand 4: hf_like_score=25.890234, validation_objective=15.890234, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:09:51,097] INFO:ptp_discovery.free_loss_eoh: Gen 5 cand 6: hf_like_score=18.457187, validation_objective=8.457187, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 18:09:51,098] INFO:ptp_discovery.free_loss_eoh: Generation 5 summary: static_fail=0, dynamic_fail=4, evaluated=3, new_elites=3
[2025-12-20 18:09:51,098] INFO:ptp_discovery.free_loss_eoh: === Generation 6/9 ===
[2025-12-20 18:09:51,098] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 18:10:04,834] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:10:13,655] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:10:28,276] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:10:40,056] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:10:53,744] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:11:04,774] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:11:19,893] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:11:33,579] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:11:47,631] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:11:59,193] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:12:14,144] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:12:27,265] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:12:41,380] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:12:53,516] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:13:09,347] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:13:22,123] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:13:22,126] INFO:ptp_discovery.free_loss_eoh: Population size for generation 6: 8
[2025-12-20 18:13:33,624] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:13:33,626] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A `batch` dictionary with keys `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight`. An `extra` dictionary with `hyperparams`. The execution environment provides `torch` and `torch.nn.functional` as `F`.'
[2025-12-20 18:13:46,462] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:13:46,465] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='The `batch` dictionary is expected to contain `cost_a`, `cost_b`, `log_prob_w`, and `log_prob_l` as PyTorch tensors. It may optionally contain a `weight` tensor.'
[2025-12-20 18:13:46,475] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=2, name=AdaptiveFocalHingeLoss: reason=forward_error: 'relu', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:13:59,404] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:13:59,406] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` with keys `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight`.\nAn `extra` dictionary containing `hyperparams` and whitelisted operator functions (`relu`, `sigmoid`, `zscore`, `pow`).'
[2025-12-20 18:13:59,416] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=2, name=AdaptiveFocalHingeLoss: reason=forward_error: 'relu', loss_value=None, grad_norm=None
[2025-12-20 18:14:09,041] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:14:09,043] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` with keys `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optional `weight`.'
[2025-12-20 18:14:09,052] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=4, name=FocalHingeBradleyTerryLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:14:19,052] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:14:19,054] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optionally 'weight'. An 'extra' object containing an 'ops' object with operator methods and a 'hyperparams' dictionary."
[2025-12-20 18:14:19,064] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=4, name=FocalHingeBradleyTerryLoss: reason=forward_error: 'ops', loss_value=None, grad_norm=None
[2025-12-20 18:14:31,055] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:14:31,058] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` containing `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors.'
[2025-12-20 18:14:42,938] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:14:42,940] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'."
[2025-12-20 18:14:42,950] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=5, name=SigmoidScaledFocalHingeLoss: reason=forward_error: 'NoneType' object is not callable, loss_value=None, grad_norm=None
[2025-12-20 18:14:54,038] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:14:54,040] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A `batch` dictionary with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors.'
[2025-12-20 18:14:54,049] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=6, name=FocalHingeBradleyTerryHybrid: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:15:06,525] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:15:06,534] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=6, name=FocalHingeBradleyTerryHybrid: reason=forward_error: 'core', loss_value=None, grad_norm=None
[2025-12-20 18:15:18,327] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:15:18,330] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors. An `extra` dictionary containing `hyperparams`.'
[2025-12-20 18:15:18,340] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=6, idx=7, name=FocalHingeHybridLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 18:15:30,095] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 18:15:30,098] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='PyTorch tensors for log_prob_w, log_prob_l, cost_a, cost_b, and optional weights.'
[free_loss_eoh][device_worker] pid=173597 device=cuda:0 jobs=[(6, 0)]
[free_loss_eoh][device_worker] pid=173598 device=cuda:1 jobs=[(6, 1)]
[free_loss_eoh][device_worker] pid=173599 device=cuda:2 jobs=[(6, 3)]
[2025-12-20 19:49:23,959] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 0: hf_like_score=32.345085, validation_objective=22.345085, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 19:49:23,959] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 1: hf_like_score=31.257371, validation_objective=21.257212, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 19:49:23,960] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 3: hf_like_score=18.311088, validation_objective=8.298678, epoch_mean=8.311083, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 19:49:23,960] INFO:ptp_discovery.free_loss_eoh: Generation 6 summary: static_fail=0, dynamic_fail=4, evaluated=3, new_elites=3
[2025-12-20 19:49:23,960] INFO:ptp_discovery.free_loss_eoh: === Generation 7/9 ===
[2025-12-20 19:49:23,960] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 19:49:37,917] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:49:51,936] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:50:07,507] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:50:20,728] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:50:35,961] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:50:48,445] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:51:04,454] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:51:18,631] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:51:34,075] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:51:47,406] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:52:03,510] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:52:15,646] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:52:31,209] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:52:44,463] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:52:59,821] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:53:12,851] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:53:12,854] INFO:ptp_discovery.free_loss_eoh: Population size for generation 7: 8
[2025-12-20 19:53:24,846] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:53:24,848] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors.'
[2025-12-20 19:53:33,879] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:53:33,893] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=7, idx=2, name=CostScaledFocalMarginLoss: reason=forward_error: 'imports', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 19:53:44,397] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:53:44,400] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optionally 'weight'. 'log_prob_w' and 'log_prob_l' are the log probabilities of the winning and losing responses, respectively. An `extra` dictionary is also provided, which can contain a 'hyperparams' sub-dictionary."
[2025-12-20 19:53:56,721] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:53:56,724] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'. 'log_prob_w' and 'log_prob_l' are the log probabilities of the winning and losing responses, respectively. 'cost_a' and 'cost_b' are their associated costs."
[2025-12-20 19:53:56,732] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=7, idx=3, name=AdaptiveFocalBradleyTerry: reason=forward_error: 'torch', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 19:54:08,452] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:54:08,455] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l' tensors, and an optional 'weight' tensor. 'log_prob_w' and 'log_prob_l' are the log probabilities of the winning and losing responses, respectively."
[2025-12-20 19:54:20,191] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:54:20,194] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary containing `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors.'
[2025-12-20 19:54:20,203] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=7, idx=4, name=FocalBradleyTerryWithAdaptiveMargin: reason=forward_error: generated_loss() missing 1 required positional argument: 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 19:54:32,341] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:54:32,352] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=7, idx=4, name=FocalBradleyTerryWithAdaptiveMargin: reason=forward_error: generated_loss() missing 1 required positional argument: 'operators', loss_value=None, grad_norm=None
[2025-12-20 19:54:43,494] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:54:43,497] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of dictionaries, where each dictionary contains `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and an optional `weight`.'
[2025-12-20 19:54:43,505] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=7, idx=6, name=NormalizedMarginFocalLoss: reason=forward_error: 'torch', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 19:54:55,744] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 19:54:55,754] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=7, idx=6, name=NormalizedMarginFocalLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=9298 device=cuda:0 jobs=[(7, 0), (7, 5)]
[free_loss_eoh][device_worker] pid=9301 device=cuda:3 jobs=[(7, 3)]
[free_loss_eoh][device_worker] pid=9300 device=cuda:2 jobs=[(7, 2)]
[free_loss_eoh][device_worker] pid=9299 device=cuda:1 jobs=[(7, 1), (7, 7)]
[2025-12-20 21:27:33,434] INFO:ptp_discovery.free_loss_eoh: Gen 7 cand 0: hf_like_score=18.534111, validation_objective=8.534111, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 21:27:33,434] INFO:ptp_discovery.free_loss_eoh: Gen 7 cand 1: hf_like_score=18.499154, validation_objective=8.479571, epoch_mean=8.498760, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 21:27:33,434] INFO:ptp_discovery.free_loss_eoh: Gen 7 cand 2: hf_like_score=33.338014, validation_objective=23.338014, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 21:27:33,435] INFO:ptp_discovery.free_loss_eoh: Gen 7 cand 3: hf_like_score=33.409877, validation_objective=23.405974, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 21:27:33,435] INFO:ptp_discovery.free_loss_eoh: Gen 7 cand 5: hf_like_score=32.136738, validation_objective=22.136738, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 21:27:33,435] INFO:ptp_discovery.free_loss_eoh: Gen 7 cand 7: hf_like_score=18.449960, validation_objective=8.449960, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 21:27:33,435] INFO:ptp_discovery.free_loss_eoh: Generation 7 summary: static_fail=0, dynamic_fail=2, evaluated=6, new_elites=6
[2025-12-20 21:27:33,435] INFO:ptp_discovery.free_loss_eoh: === Generation 8/9 ===
[2025-12-20 21:27:33,436] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 21:27:49,154] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:28:01,416] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:28:18,952] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:28:32,236] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:28:49,558] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:29:03,389] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:29:20,065] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:29:34,478] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:29:50,930] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:30:05,320] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:30:21,692] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:30:35,584] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:30:52,650] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:31:07,145] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:31:22,866] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:31:35,904] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:31:35,907] INFO:ptp_discovery.free_loss_eoh: Population size for generation 8: 8
[2025-12-20 21:31:46,450] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:31:46,453] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` containing `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight` tensors.'
[2025-12-20 21:31:46,460] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=0, name=FocalLogMarginBradleyTerry: reason=forward_error: generated_loss() missing 2 required positional arguments: 'torch' and 'F', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 21:31:57,834] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:31:57,836] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'. 'log_prob_w' and 'log_prob_l' are the log probabilities of the winning and losing responses, respectively. 'cost_a' and 'cost_b' are their associated costs."
[2025-12-20 21:32:09,077] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:32:09,079] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` containing `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and an optional `weight` tensor. A dictionary `extra` containing `hyperparams`.'
[2025-12-20 21:32:09,090] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=1, name=ScaledFocalMarginBradleyTerry: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 21:32:20,503] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:32:20,505] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` with keys `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and an optional `weight`. An `extra` dictionary containing `hyperparams` and `operators`.'
[2025-12-20 21:32:20,513] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=1, name=ScaledFocalMarginBradleyTerry: reason=forward_error: 'operators', loss_value=None, grad_norm=None
[2025-12-20 21:32:33,221] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:32:33,223] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of contrastive pairs `(a, b)` with `cost_a`, `cost_b`, `logp_a`, `logp_b`.'
[2025-12-20 21:32:33,233] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=2, name=NormalizedFocalMarginBradleyTerryLoss: reason=forward_error: 'torch', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 21:32:47,046] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:32:47,049] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'."
[2025-12-20 21:32:47,057] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=2, name=NormalizedFocalMarginBradleyTerryLoss: reason=forward_error: 'torch', loss_value=None, grad_norm=None
[2025-12-20 21:32:59,089] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:32:59,092] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A dictionary `batch` containing `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight` as PyTorch tensors. `log_prob_w` corresponds to the preferred response 'a' and `log_prob_l` to the dispreferred response 'b'."
[2025-12-20 21:33:10,250] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:33:10,446] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch of paired data with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`. `log_prob_w` corresponds to the preferred item 'a', and `log_prob_l` to the dispreferred item 'b'. Optional `weight` tensor for sample weighting."
[2025-12-20 21:33:21,241] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:33:21,244] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A `batch` dictionary with keys `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optionally `weight`. An `extra` dictionary containing `hyperparams`.'
[2025-12-20 21:33:21,253] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=5, name=ZScoreScaledMarginFocalLoss: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 21:33:32,583] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:33:32,586] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary with `cost_a`, `cost_b`, `log_prob_w`, `log_prob_l`, and optional `weight` tensors.'
[2025-12-20 21:33:32,595] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=5, name=ZScoreScaledMarginFocalLoss: reason=forward_error: name 'softplus' is not defined, loss_value=None, grad_norm=None
[2025-12-20 21:33:46,575] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:33:46,577] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary with `cost_a`, `cost_b` (costs of two samples), `log_prob_w`, `log_prob_l` (log-probabilities of the preferred and less-preferred samples), and an optional `weight` tensor.'
[2025-12-20 21:33:46,586] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=6, name=NormalizedCostFocalMarginLoss: reason=forward_error: 'torch', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 21:33:58,422] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 21:33:58,615] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A dictionary `batch` with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'. Also expects `torch` and `torch.nn.functional` to be available as `torch` and `F`."
[2025-12-20 21:33:58,622] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=8, idx=6, name=NormalizedCostFocalMarginLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'torch' and 'F', loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=76312 device=cuda:1 jobs=[(8, 4)]
[free_loss_eoh][device_worker] pid=76311 device=cuda:0 jobs=[(8, 3)]
[free_loss_eoh][device_worker] pid=76313 device=cuda:2 jobs=[(8, 7)]
[2025-12-20 23:06:03,383] INFO:ptp_discovery.free_loss_eoh: Gen 8 cand 3: hf_like_score=18.419032, validation_objective=8.419032, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 23:06:03,383] INFO:ptp_discovery.free_loss_eoh: Gen 8 cand 4: hf_like_score=18.486118, validation_objective=8.406155, epoch_mean=8.486118, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 23:06:03,383] INFO:ptp_discovery.free_loss_eoh: Gen 8 cand 7: hf_like_score=29.854088, validation_objective=19.846823, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-20 23:06:03,384] INFO:ptp_discovery.free_loss_eoh: Generation 8 summary: static_fail=0, dynamic_fail=4, evaluated=3, new_elites=3
[2025-12-20 23:06:03,384] INFO:ptp_discovery.free_loss_eoh: === Generation 9/9 ===
[2025-12-20 23:06:03,384] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-20 23:06:20,377] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:06:36,344] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:06:52,499] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:07:06,695] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:07:24,407] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:07:38,752] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:07:55,181] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:08:08,880] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:08:24,429] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:08:37,704] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:08:54,150] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:09:08,436] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:09:27,371] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:09:41,762] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:09:57,217] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:10:10,407] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:10:10,409] INFO:ptp_discovery.free_loss_eoh: Population size for generation 9: 8
[2025-12-20 23:10:22,950] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:10:22,952] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of paired samples `(a, b)` where `a` is preferred over `b`. The batch must provide `log_prob_w` (log probability of sequence `a`), `log_prob_l` (log probability of sequence `b`), `cost_a`, and `cost_b`. `cost_a` must be less than `cost_b`.'
[2025-12-20 23:10:34,446] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:10:34,449] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A dictionary `batch` containing `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optionally `weight` tensors.'
[2025-12-20 23:10:34,459] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=9, idx=1, name=NormalizedCostMarginFocalLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 23:10:45,949] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:10:45,952] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch dictionary containing at least `cost_a`, `cost_b`, `log_prob_w` (for winner `a`), and `log_prob_l` (for loser `b`). Optionally, it can contain a `weight` tensor for sample weighting.'
[2025-12-20 23:10:57,097] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:10:57,099] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='PyTorch tensors `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optional `weight`.'
[2025-12-20 23:10:57,110] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=9, idx=2, name=AdaptiveMarginFocalBradleyTerryLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 23:11:09,102] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:11:09,105] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of paired samples `(a, b)` where `a` is preferred over `b`, with fields `log_prob_w`, `log_prob_l`, `cost_a`, `cost_b`, and optional `weight`.'
[2025-12-20 23:11:09,115] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=9, idx=2, name=AdaptiveMarginFocalBradleyTerryLoss: reason=forward_error: 'operators', loss_value=None, grad_norm=None
[2025-12-20 23:11:19,993] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:11:19,995] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch of dictionaries, each with 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l'. 'weight' is optional."
[2025-12-20 23:11:31,791] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:11:43,202] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:11:43,204] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="`batch` is a dict with keys `'cost_a'`, `'cost_b'`, `'log_prob_w'`, `'log_prob_l'`, and optionally `'weight'`. `model_output` is not used. `extra` is a dict containing `hyperparams`."
[2025-12-20 23:11:43,213] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=9, idx=5, name=NormalizedMarginFocalBradleyTerry: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 23:11:55,676] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:11:55,679] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of paired samples `(a, b)` where `a` is preferred over `b`. The batch must contain `log_prob_w` (log-probability of the preferred sample `a`), `log_prob_l` (log-probability of the dispreferred sample `b`), `cost_a` (cost of `a`), and `cost_b` (cost of `b`). It may optionally contain `weight` for each pair.'
[2025-12-20 23:12:08,050] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:12:19,892] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:12:19,894] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw='A batch of preference pairs with fields `cost_a`, `cost_b`, `log_prob_w`, and `log_prob_l`. `log_prob_w` corresponds to the preferred completion (`a`), and `log_prob_l` to the dispreferred one (`b`).'
[2025-12-20 23:12:19,911] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=9, idx=6, name=HybridMarginFocalBradleyTerry: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None
[2025-12-20 23:12:32,018] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:12:32,028] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=9, idx=7, name=NormalizedCostScaledFocalMarginLoss: reason=forward_error: name 'sigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-20 23:12:43,338] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-20 23:12:43,340] DEBUG:ptp_discovery.free_loss_ir: implementation_hint.expects not array or Mapping; type=<class 'str'>, raw="A batch dictionary with keys 'cost_a', 'cost_b', 'log_prob_w', 'log_prob_l', and optional 'weight'. An 'extra' dictionary with 'hyperparams' and 'operators'."
[2025-12-20 23:12:43,351] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=9, idx=7, name=NormalizedCostScaledFocalMarginLoss: reason=forward_error: 'operators', loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=155933 device=cuda:0 jobs=[(9, 0)]
[free_loss_eoh][device_worker] pid=155936 device=cuda:2 jobs=[(9, 4)]
[free_loss_eoh][device_worker] pid=155935 device=cuda:1 jobs=[(9, 3)]
[2025-12-21 00:44:33,860] INFO:ptp_discovery.free_loss_eoh: Gen 9 cand 0: hf_like_score=18.393008, validation_objective=8.321520, epoch_mean=8.393008, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-21 00:44:33,860] INFO:ptp_discovery.free_loss_eoh: Gen 9 cand 3: hf_like_score=18.545487, validation_objective=8.545487, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-21 00:44:33,860] INFO:ptp_discovery.free_loss_eoh: Gen 9 cand 4: hf_like_score=24.837084, validation_objective=14.829821, epoch_mean=nan, epoch_violations=10, baseline=7.940532, better_than_baseline=False
[2025-12-21 00:44:33,860] INFO:ptp_discovery.free_loss_eoh: Generation 9 summary: static_fail=0, dynamic_fail=3, evaluated=3, new_elites=3
[2025-12-21 00:44:33,877] INFO:ptp_discovery.free_loss_eoh: Search complete. Best hf_like_score=18.196041 (generation=3, index=3)
