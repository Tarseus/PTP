[2025-12-15 10:44:38,458] INFO:ptp_discovery.free_loss_eoh: Starting free loss EoH search with config=configs/free_loss_discovery.yaml
[2025-12-15 10:44:41,390] INFO:ptp_discovery.free_loss_eoh: Baseline PO training: steps=1563, train_problem_size=100, pomo_size=20, batch_size=64, device=cuda, init_time=1.768s
[2025-12-15 10:44:43,053] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1/0: score=48.913048 (avg=48.913048), loss=0.351714 (avg=0.351714)
[2025-12-15 10:45:09,274] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 78/0: score=9.615820 (avg=12.004824), loss=0.275802 (avg=0.288048)
[2025-12-15 10:45:35,653] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 156/0: score=9.163793 (avg=10.677306), loss=0.277972 (avg=0.283651)
[2025-12-15 10:46:01,834] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 234/0: score=8.952535 (avg=10.150949), loss=0.281601 (avg=0.283661)
[2025-12-15 10:46:28,013] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 312/0: score=8.915545 (avg=9.844451), loss=0.291230 (avg=0.283907)
[2025-12-15 10:46:54,208] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 390/0: score=8.815382 (avg=9.648300), loss=0.284786 (avg=0.284304)
[2025-12-15 10:47:20,448] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 468/0: score=8.808316 (avg=9.497291), loss=0.289354 (avg=0.284867)
[2025-12-15 10:47:46,740] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 546/0: score=8.702276 (avg=9.384005), loss=0.291027 (avg=0.285493)
[2025-12-15 10:48:13,009] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 624/0: score=8.624564 (avg=9.290077), loss=0.290065 (avg=0.285999)
[2025-12-15 10:48:39,233] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 702/0: score=8.656874 (avg=9.213748), loss=0.289535 (avg=0.286611)
[2025-12-15 10:49:05,380] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 780/0: score=8.569237 (avg=9.149497), loss=0.292285 (avg=0.287257)
[2025-12-15 10:49:31,453] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 858/0: score=8.510248 (avg=9.094118), loss=0.295775 (avg=0.287779)
[2025-12-15 10:49:57,556] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 936/0: score=8.532043 (avg=9.046446), loss=0.289866 (avg=0.288155)
[2025-12-15 10:50:23,728] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1014/0: score=8.498336 (avg=9.004030), loss=0.293455 (avg=0.288512)
[2025-12-15 10:50:49,937] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1092/0: score=8.465349 (avg=8.967141), loss=0.296828 (avg=0.288839)
[2025-12-15 10:51:16,257] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1170/0: score=8.412751 (avg=8.934203), loss=0.287775 (avg=0.289191)
[2025-12-15 10:51:42,304] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1248/0: score=8.414625 (avg=8.904520), loss=0.297752 (avg=0.289472)
[2025-12-15 10:52:08,344] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1326/0: score=8.433537 (avg=8.877203), loss=0.293053 (avg=0.289760)
[2025-12-15 10:52:34,469] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1404/0: score=8.397409 (avg=8.852603), loss=0.298278 (avg=0.290058)
[2025-12-15 10:53:00,589] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1482/0: score=8.457474 (avg=8.829898), loss=0.296416 (avg=0.290303)
[2025-12-15 10:53:26,768] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1560/0: score=8.346966 (avg=8.809064), loss=0.291828 (avg=0.290565)
[2025-12-15 10:53:27,769] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=20, episodes=128, batch_size=64
[2025-12-15 10:53:28,004] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=20, episodes=128, batch_size=64
[2025-12-15 10:53:28,236] INFO:ptp_discovery.free_loss_eoh: Baseline PO timing: init=1.768s, train=526.379s, eval=0.466s
[2025-12-15 10:53:28,237] INFO:ptp_discovery.free_loss_eoh: Baseline po_loss: hf_score=8.189414, validation_objective=8.185925, gen_penalty=0.003489
[2025-12-15 10:53:28,237] INFO:ptp_discovery.free_loss_eoh: Run directory: /data1/gushengda/PTP/runs/free_loss_discovery/20251215-105328
[2025-12-15 10:53:28,237] INFO:ptp_discovery.free_loss_eoh: === Generation 0/9 ===
[2025-12-15 10:53:28,237] INFO:ptp_discovery.free_loss_eoh: Generating initial population with 8 LLM candidates
[2025-12-15 10:53:50,685] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:54:11,675] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:54:28,568] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:54:42,103] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:54:59,711] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:55:15,065] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:55:33,621] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:55:46,717] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:56:04,786] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:56:20,431] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:56:44,673] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:57:02,213] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:57:18,935] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:57:33,620] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:57:54,793] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:58:13,433] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 10:58:13,437] INFO:ptp_discovery.free_loss_eoh: Population size for generation 0: 8
[2025-12-15 10:58:13,446] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=0, name=Dynamic Margin Sigmoid Loss with Cost Rank Normalization: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 10:58:13,449] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=1, name=Adaptive Margin Hinge Loss with Cost-Gap Normalization: reason=forward_error: 'log_prob_a', loss_value=None, grad_norm=None
[2025-12-15 10:58:13,459] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=3, name=Adaptive Margin Sigmoid Loss with Cost Rank Normalization: reason=forward_error: 'logp_a', loss_value=None, grad_norm=None
[2025-12-15 10:58:13,462] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=4, name=Asymmetric Hinge Loss with Adaptive Margin and Logit Scaling: reason=forward_error: 'logp_a', loss_value=None, grad_norm=None
[2025-12-15 10:58:13,465] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=5, name=Asymmetric Hinge Loss with Adaptive Cost-Gap Scaling: reason=forward_error: 'logp_a', loss_value=None, grad_norm=None
[2025-12-15 10:58:13,468] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=6, name=Sigmoid-Scaled Rank-Gap Loss: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 10:58:13,471] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=7, name=Sigmoidal Rank-Gap Modulated Loss: reason=forward_error: 'log_prob_w', loss_value=None, grad_norm=None
[2025-12-15 11:06:49,813] INFO:ptp_discovery.free_loss_eoh: Gen 0 cand 2: hf_like_score=45.973934, validation_objective=45.973934, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:06:49,813] INFO:ptp_discovery.free_loss_eoh: Generation 0 summary: static_fail=0, dynamic_fail=7, evaluated=1, new_elites=1
[2025-12-15 11:06:49,813] INFO:ptp_discovery.free_loss_eoh: === Generation 1/9 ===
[2025-12-15 11:06:49,813] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=1
[2025-12-15 11:07:05,323] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:07:19,282] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:07:35,054] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:07:50,397] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:08:05,647] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:08:19,345] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:08:36,198] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:08:51,563] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:09:06,217] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:09:19,722] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:09:37,176] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:09:52,705] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:10:07,283] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:10:20,265] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:10:36,711] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:10:51,887] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:10:51,890] INFO:ptp_discovery.free_loss_eoh: Population size for generation 1: 8
[2025-12-15 11:10:51,929] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=2, name=Sigmoid-Gated Hinge Loss with Rank-Gap Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:10:51,938] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=4, name=Sigmoid-Gated Hinge Loss with Rank-Gap Adaptive Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:10:51,944] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=5, name=Sigmoid-Gated Hinge Loss with Rank-Gap Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:10:51,952] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=7, name=Sigmoid-Gated Hinge Loss with Rank-Gap Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:19:40,492] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 0: hf_like_score=43.416317, validation_objective=43.297380, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:19:40,493] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 1: hf_like_score=37.773886, validation_objective=37.773886, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:19:40,493] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 3: hf_like_score=41.080242, validation_objective=41.080242, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:19:40,493] INFO:ptp_discovery.free_loss_eoh: Gen 1 cand 6: hf_like_score=42.381266, validation_objective=42.381266, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:19:40,493] INFO:ptp_discovery.free_loss_eoh: Generation 1 summary: static_fail=0, dynamic_fail=4, evaluated=4, new_elites=4
[2025-12-15 11:19:40,493] INFO:ptp_discovery.free_loss_eoh: === Generation 2/9 ===
[2025-12-15 11:19:40,493] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-15 11:19:58,762] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:20:15,034] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:20:32,329] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:20:48,426] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:21:06,906] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:21:20,536] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:21:40,491] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:21:56,845] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:22:14,809] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:22:29,103] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:22:45,859] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:23:01,272] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:23:20,560] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:23:37,707] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:23:56,989] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:24:14,566] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:24:14,569] INFO:ptp_discovery.free_loss_eoh: Population size for generation 2: 8
[2025-12-15 11:24:14,579] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=0, name=Z-Score Modulated Log-Sigmoid Loss with Tanh Margin: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:24:14,582] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=1, name=Adaptive Log-Sigmoid Loss with Z-Score Normalization and Tanh Margin: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:24:14,584] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=2, name=Adaptive Log-Sigmoid Loss with Z-Score Normalization and Tanh Margin: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:24:14,587] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=3, name=Rank-Normalized Log-Sigmoid Loss with Adaptive Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:24:14,595] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=5, name=Z-Scored Log-Sigmoid Loss with Tanh-Scaled Adaptive Margin: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:24:14,599] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=6, name=Adaptive Log-Sigmoid Loss with Tanh-Gated Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:24:14,603] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=7, name=Rank-Normalized Bradley-Terry Loss with Tanh Margin: reason=forward_error: name 'zscore' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:33:00,376] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 4: hf_like_score=8.313655, validation_objective=8.283032, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:33:00,377] INFO:ptp_discovery.free_loss_eoh: Generation 2 summary: static_fail=0, dynamic_fail=7, evaluated=1, new_elites=1
[2025-12-15 11:33:00,377] INFO:ptp_discovery.free_loss_eoh: === Generation 3/9 ===
[2025-12-15 11:33:00,377] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-15 11:33:19,982] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:33:39,558] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:34:00,629] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:34:18,275] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:34:38,897] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:34:56,947] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:35:17,245] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:35:35,304] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:35:56,690] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:36:15,595] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:36:35,952] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:36:51,379] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:37:12,322] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:37:28,292] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:37:48,166] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:38:05,772] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:38:05,776] INFO:ptp_discovery.free_loss_eoh: Population size for generation 3: 8
[2025-12-15 11:38:05,785] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=0, name=Gated Log-Sigmoid Loss with Rank-Gap Margin and Z-Score Normalization: reason=forward_error: name '_rank_fn' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:38:05,790] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=1, name=Rank-Gated Log-Sigmoid Loss with Tanh Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:38:05,797] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=3, name=Gated Log-Sigmoid Loss with Z-Score Normalization and Rank-Gap Margin: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:38:05,805] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=5, name=Gated Log-Sigmoid Loss with Tanh Margin and Rank-Gap Normalization: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:38:05,815] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=7, name=Gated Log-Sigmoid Loss with Z-Score Normalization and Rank-Gap Margin: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:47:00,254] INFO:ptp_discovery.free_loss_eoh: Gen 3 cand 2: hf_like_score=10.628462, validation_objective=10.534806, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:47:00,254] INFO:ptp_discovery.free_loss_eoh: Gen 3 cand 4: hf_like_score=8.324538, validation_objective=8.324538, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:47:00,254] INFO:ptp_discovery.free_loss_eoh: Gen 3 cand 6: hf_like_score=22.017813, validation_objective=22.017813, baseline=8.189414, better_than_baseline=False
[2025-12-15 11:47:00,254] INFO:ptp_discovery.free_loss_eoh: Generation 3 summary: static_fail=0, dynamic_fail=5, evaluated=3, new_elites=3
[2025-12-15 11:47:00,254] INFO:ptp_discovery.free_loss_eoh: === Generation 4/9 ===
[2025-12-15 11:47:00,254] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-15 11:47:20,206] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:47:35,241] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:47:56,386] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:48:16,300] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:48:37,372] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:48:56,342] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:49:20,054] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:49:38,194] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:50:02,146] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:50:23,656] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:50:45,741] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:51:04,206] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:51:28,298] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:51:48,754] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:52:09,681] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:52:25,226] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 11:52:25,234] INFO:ptp_discovery.free_loss_eoh: Population size for generation 4: 8
[2025-12-15 11:52:25,244] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=0, name=Gated Log-Sigmoid Loss with Batch Rank-Gap Normalization: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:52:25,255] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=2, name=Rank-Gapped Sigmoid Loss with Gated Normalization: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:52:25,261] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=3, name=Rank-Gapped Log-Sigmoid Loss with Tanh Margin and Dynamic Gating: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:52:25,265] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=4, name=Rank-Gated Log-Sigmoid Loss with Dynamic Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:52:25,269] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=5, name=Rank-Gap Gated Log-Sigmoid Loss with Tanh Margin: reason=loss 380797.0938 outside soft range [-5.0, 5.0], loss_value=380797.09375, grad_norm=0.0
[2025-12-15 11:52:25,274] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=6, name=Rank-Gapped Log-Sigmoid Loss with Tanh Margin and Dynamic Gating: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 11:52:25,278] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=4, idx=7, name=Rank-Gated Log-Sigmoid Loss with Tanh Margin: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 12:01:16,031] INFO:ptp_discovery.free_loss_eoh: Gen 4 cand 1: hf_like_score=40.488886, validation_objective=40.488886, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:01:16,031] INFO:ptp_discovery.free_loss_eoh: Generation 4 summary: static_fail=0, dynamic_fail=7, evaluated=1, new_elites=1
[2025-12-15 12:01:16,031] INFO:ptp_discovery.free_loss_eoh: === Generation 5/9 ===
[2025-12-15 12:01:16,031] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-15 12:01:36,984] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:01:55,547] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:02:24,924] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:02:43,789] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:03:06,380] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:03:22,795] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:03:44,333] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:04:02,148] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:04:21,529] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:04:37,665] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:04:57,128] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:05:12,500] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:05:35,551] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:05:54,607] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:06:15,016] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:06:33,938] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:06:33,942] INFO:ptp_discovery.free_loss_eoh: Population size for generation 5: 8
[2025-12-15 12:06:33,954] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=1, name=Rank-Correlated Sigmoid Loss with Gated Tanh Margin: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 12:06:33,959] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=2, name=Rank-Gated Log-Sigmoid Loss with Tanh Margin: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 12:06:33,963] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=3, name=Adaptive Gated Sigmoid Loss with Rank-Gap Normalization: reason=forward_error: name 'rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 12:06:33,966] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=4, name=Rank-Gated Log-Sigmoid Loss with Tanh Margin: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 12:06:33,975] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=6, name=Rank-Gated Log-Sigmoid Loss with Z-Score Normalization: reason=forward_error: 'float' object has no attribute 'clamp', loss_value=None, grad_norm=None
[2025-12-15 12:06:33,980] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=5, idx=7, name=Rank-Gated Log-Sigmoid Loss with Z-Score Normalization: reason=forward_error: name '_rank_gap' is not defined, loss_value=None, grad_norm=None
[2025-12-15 12:15:17,424] INFO:ptp_discovery.free_loss_eoh: Gen 5 cand 0: hf_like_score=8.301809, validation_objective=8.279944, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:15:17,424] INFO:ptp_discovery.free_loss_eoh: Gen 5 cand 5: hf_like_score=8.860576, validation_objective=8.860576, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:15:17,425] INFO:ptp_discovery.free_loss_eoh: Generation 5 summary: static_fail=0, dynamic_fail=6, evaluated=2, new_elites=2
[2025-12-15 12:15:17,425] INFO:ptp_discovery.free_loss_eoh: === Generation 6/9 ===
[2025-12-15 12:15:17,425] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-15 12:15:36,862] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:15:55,227] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:16:16,201] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:16:33,250] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:16:53,471] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:17:11,278] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:17:32,187] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:17:52,975] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:18:13,615] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:18:30,774] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:18:51,005] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:19:08,422] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:19:29,891] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:19:44,578] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:20:03,418] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:20:20,447] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-15 12:20:20,450] INFO:ptp_discovery.free_loss_eoh: Population size for generation 6: 8
[2025-12-15 12:37:50,615] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 0: hf_like_score=32.184967, validation_objective=32.030352, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:37:50,615] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 1: hf_like_score=24.503512, validation_objective=24.503512, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:37:50,615] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 2: hf_like_score=8.275791, validation_objective=8.271461, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:37:50,616] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 3: hf_like_score=8.300241, validation_objective=8.300034, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:37:50,616] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 4: hf_like_score=8.311193, validation_objective=8.311193, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:37:50,616] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 6: hf_like_score=8.288273, validation_objective=8.279249, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:37:50,616] INFO:ptp_discovery.free_loss_eoh: Gen 6 cand 7: hf_like_score=46.523304, validation_objective=46.523304, baseline=8.189414, better_than_baseline=False
[2025-12-15 12:37:50,616] INFO:ptp_discovery.free_loss_eoh: Generation 6 summary: static_fail=1, dynamic_fail=0, evaluated=7, new_elites=7
[2025-12-15 12:37:50,616] INFO:ptp_discovery.free_loss_eoh: === Generation 7/9 ===
[2025-12-15 12:37:50,616] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=4
[2025-12-15 12:38:10,546] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
Traceback (most recent call last):
  File "/data1/gushengda/PTP/ptp_discovery/free_loss_compiler.py", line 112, in _extract_json_object
    return json.loads(sanitized_snippet)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/anaconda3/envs/rlco/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/anaconda3/envs/rlco/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/anaconda3/envs/rlco/lib/python3.11/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 19 column 1 (char 3777)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data1/gushengda/PTP/ptp_discovery/run_free_loss_eoh.py", line 54, in <module>
    main()
  File "/data1/gushengda/PTP/ptp_discovery/run_free_loss_eoh.py", line 50, in main
    run_free_loss_eoh(args.config, **overrides)
  File "/data1/gushengda/PTP/ptp_discovery/free_loss_eoh_loop.py", line 442, in run_free_loss_eoh
    ir = crossover_free_loss(crossover_prompt, parent_irs[:2])
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/gushengda/PTP/ptp_discovery/free_loss_llm_ops.py", line 88, in crossover_free_loss
    return parse_free_loss_from_text(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/gushengda/PTP/ptp_discovery/free_loss_compiler.py", line 150, in parse_free_loss_from_text
    obj = _extract_json_object(text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/gushengda/PTP/ptp_discovery/free_loss_compiler.py", line 114, in _extract_json_object
    raise CompileError(f"Failed to parse JSON from LLM output: {exc}") from exc
ptp_discovery.free_loss_compiler.CompileError: Failed to parse JSON from LLM output: Expecting property name enclosed in double quotes: line 19 column 1 (char 3777)
