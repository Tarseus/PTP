[2025-12-21 17:30:19,010] INFO:ptp_discovery.free_loss_eoh: Starting free loss EoH search with config=configs/free_loss_discovery.yaml
[2025-12-21 17:30:21,904] INFO:ptp_discovery.free_loss_eoh: Baseline PO training: steps=15630, train_problem_size=100, pomo_size=100, batch_size=64, device=cuda, init_time=1.794s
[2025-12-21 17:30:23,505] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1/15630: score=48.226318 (avg=48.226318), loss=0.356016 (avg=0.356016)
[2025-12-21 17:30:57,458] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 17:35:05,465] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 781/15630: score=8.245622 (avg=8.621181), loss=0.308787 (avg=0.302969)
[2025-12-21 17:39:32,805] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 1562/15630: score=8.078932 (avg=8.384007), loss=0.314117 (avg=0.306768)
[2025-12-21 17:39:33,142] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 17:39:52,121] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 1/10: validation_objective=8.021967
[2025-12-21 17:44:11,659] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 2343/15630: score=8.099611 (avg=8.284331), loss=0.316162 (avg=0.309256)
[2025-12-21 17:48:22,625] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 3124/15630: score=8.056530 (avg=8.226872), loss=0.316332 (avg=0.310961)
[2025-12-21 17:48:23,305] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 17:48:41,724] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 2/10: validation_objective=7.990933
[2025-12-21 17:53:06,553] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 3905/15630: score=7.999968 (avg=8.188539), loss=0.317454 (avg=0.312230)
[2025-12-21 17:57:31,182] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 4686/15630: score=8.003972 (avg=8.160288), loss=0.320423 (avg=0.313296)
[2025-12-21 17:57:32,214] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 17:57:50,928] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 3/10: validation_objective=7.971084
[2025-12-21 18:02:16,611] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 5467/15630: score=7.977758 (avg=8.137808), loss=0.320878 (avg=0.314263)
[2025-12-21 18:06:37,046] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 6248/15630: score=7.993860 (avg=8.119694), loss=0.321334 (avg=0.315152)
[2025-12-21 18:06:38,393] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 18:06:57,031] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 4/10: validation_objective=7.953436
[2025-12-21 18:11:19,183] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 7029/15630: score=7.991011 (avg=8.104407), loss=0.325091 (avg=0.315952)
[2025-12-21 18:15:44,004] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 7810/15630: score=7.882179 (avg=8.090984), loss=0.324067 (avg=0.316650)
[2025-12-21 18:15:45,699] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 18:16:04,371] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 5/10: validation_objective=7.935316
[2025-12-21 18:20:28,127] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 8591/15630: score=7.988118 (avg=8.079318), loss=0.322338 (avg=0.317287)
[2025-12-21 18:24:49,530] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 9372/15630: score=7.959532 (avg=8.068932), loss=0.323986 (avg=0.317846)
[2025-12-21 18:24:51,532] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 18:25:10,059] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 6/10: validation_objective=7.927230
[2025-12-21 18:29:30,341] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 10153/15630: score=7.953410 (avg=8.059627), loss=0.325224 (avg=0.318345)
[2025-12-21 18:33:53,936] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 10934/15630: score=7.958483 (avg=8.051196), loss=0.324200 (avg=0.318801)
[2025-12-21 18:33:56,316] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 18:34:14,919] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 7/10: validation_objective=7.923507
[2025-12-21 18:38:36,549] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 11715/15630: score=7.914311 (avg=8.043364), loss=0.323887 (avg=0.319210)
[2025-12-21 18:42:56,070] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 12496/15630: score=7.946341 (avg=8.036385), loss=0.326506 (avg=0.319586)
[2025-12-21 18:42:58,715] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 18:43:17,276] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 8/10: validation_objective=7.907744
[2025-12-21 18:47:37,040] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 13277/15630: score=7.867523 (avg=8.029802), loss=0.324733 (avg=0.319931)
[2025-12-21 18:52:01,258] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 14058/15630: score=7.912079 (avg=8.023809), loss=0.327987 (avg=0.320254)
[2025-12-21 18:52:04,321] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 18:52:23,257] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 9/10: validation_objective=7.895562
[2025-12-21 18:56:44,702] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 14839/15630: score=7.880696 (avg=8.018110), loss=0.325995 (avg=0.320551)
[2025-12-21 19:01:08,978] INFO:ptp_discovery.free_loss_eoh: Baseline PO step 15620/15630: score=7.932843 (avg=8.012674), loss=0.326479 (avg=0.320837)
[2025-12-21 19:01:12,485] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 19:01:31,351] INFO:ptp_discovery.free_loss_eoh: Baseline PO epoch 10/10: validation_objective=7.893194
[2025-12-21 19:01:31,351] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 19:01:50,110] INFO:fitness.ptp_high_fidelity: Evaluating TSP model: problem_size=100, pomo_size=100, episodes=10000, batch_size=64
[2025-12-21 19:02:08,635] INFO:ptp_discovery.free_loss_eoh: Baseline PO timing: init=1.794s, train=5469.447s, eval=37.284s
[2025-12-21 19:02:08,637] INFO:ptp_discovery.free_loss_eoh: Baseline po_loss: hf_score=7.894782, fitness_score=7.942243, validation_objective=7.894537, gen_penalty=0.000245
[2025-12-21 19:02:08,638] INFO:ptp_discovery.free_loss_eoh: Run directory: /data1/gushengda/PTP/runs/free_loss_discovery/20251221-190208
[2025-12-21 19:02:08,638] INFO:ptp_discovery.free_loss_eoh: === Generation 0/9 ===
[2025-12-21 19:02:08,638] INFO:ptp_discovery.free_loss_eoh: Generating initial population with 8 LLM candidates
[2025-12-21 19:02:23,848] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:02:36,238] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:02:51,028] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:03:03,854] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:03:19,848] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:03:32,687] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:03:48,408] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:04:01,451] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:04:17,602] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:04:30,231] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:04:45,083] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:04:56,977] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:05:12,653] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:05:25,710] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:05:41,608] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:05:53,988] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:05:53,991] INFO:ptp_discovery.free_loss_eoh: Population size for generation 0: 8
[2025-12-21 19:06:04,416] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:06:04,425] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=0, name=AdaptiveSigmoidFlowLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:06:15,955] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:06:15,965] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=0, name=AdaptiveSigmoidFlowLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:06:27,110] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:06:27,123] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=1, name=SkewedHingeLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'log_prob_l' and 'hyperparams', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:06:38,543] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:06:38,556] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=1, name=SkewedHingeLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'log_prob_l' and 'hyperparams', loss_value=None, grad_norm=None
[2025-12-21 19:06:50,941] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:06:50,953] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=2, name=Adaptive Focal Hinge Loss: reason=missing_dependency: name 'clamp' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:07:06,533] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:07:18,606] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:07:29,902] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:07:29,914] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=2, name=AdaptiveSigmoidFlowLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'operators', and 'hyperparams', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:07:40,273] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:07:40,285] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=2, name=AdaptiveSigmoidFlowLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'operators', and 'hyperparams', loss_value=None, grad_norm=None
[2025-12-21 19:07:52,704] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:07:52,717] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=3, name=AdaptiveSigmoidFocalLoss: reason=missing_dependency: name 'sigmoid' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:08:10,766] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:08:25,546] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:08:39,712] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:08:53,106] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:09:03,601] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:09:03,614] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=4, name=AdaptiveMarginHingeLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'log_prob_l' and 'hyperparams', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:09:15,063] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:09:15,073] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=4, name=AdaptiveMarginHingeLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'log_prob_l' and 'hyperparams', loss_value=None, grad_norm=None
[2025-12-21 19:09:26,005] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:09:26,017] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=5, name=SkewedMarginLogSigmoid: reason=forward_error: generated_loss() missing 1 required positional argument: 'torch', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:09:37,022] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:09:37,032] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=5, name=SkewedMarginLogSigmoid: reason=forward_error: module 'torch' has no attribute 'softplus', loss_value=None, grad_norm=None
[2025-12-21 19:09:47,081] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:09:47,093] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=6, name=AdaptiveSigmoidFlowLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'operators', and 'hyperparams', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:09:56,881] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:09:56,890] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=6, name=AdaptiveSigmoidFlowLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'operators', and 'hyperparams', loss_value=None, grad_norm=None
[2025-12-21 19:10:08,482] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:10:19,116] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:10:19,128] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=7, name=AdaptiveSigmoidFocalLoss: reason=missing_batch_key: 'log_prob_w'; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:10:31,248] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:10:41,744] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:10:50,837] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:10:50,850] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=7, name=RankGapAdaptiveLogSigmoid: reason=forward_error: generated_loss() missing 4 required positional arguments: 'log_prob_l', 'hyperparams', 'a_op', and 'b_op', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:10:59,872] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:10:59,881] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=0, idx=7, name=RankGapAdaptiveLogSigmoid: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:10:59,882] INFO:ptp_discovery.free_loss_eoh: Generation 0 summary: static_fail=0, dynamic_fail=7, evaluated=0, new_elites=0
[2025-12-21 19:10:59,882] INFO:ptp_discovery.free_loss_eoh: === Generation 1/9 ===
[2025-12-21 19:10:59,882] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=0
[2025-12-21 19:11:15,670] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:11:27,328] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:11:42,917] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:11:55,078] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:12:08,430] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:12:19,359] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:12:32,278] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:12:43,394] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:13:00,584] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:13:14,219] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:13:29,816] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:13:41,820] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:13:56,823] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:14:08,510] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:14:21,985] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:14:33,715] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:14:33,718] INFO:ptp_discovery.free_loss_eoh: Population size for generation 1: 8
[2025-12-21 19:14:44,271] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:14:44,286] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=0, name=AdaptiveSigmoidFocalLoss: reason=forward_error: generated_loss() missing 1 required positional argument: 'ops', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:14:54,366] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:14:54,378] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=0, name=AdaptiveSigmoidFocalLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'extra', and 'ops', loss_value=None, grad_norm=None
[2025-12-21 19:15:04,138] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:15:04,149] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=1, name=AdaptiveTanhMarginLoss: reason=missing_dependency: name 'tanh' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:15:20,026] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:15:31,648] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:15:42,999] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:15:43,011] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=1, name=AdaptiveFocalLogLoss: reason=missing_dependency: name 'mean' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:15:54,311] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:15:54,322] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=1, name=AdaptiveFocalLogLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'log_prob_l' and 'hyperparams', loss_value=None, grad_norm=None
[2025-12-21 19:16:04,152] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:16:14,925] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:16:14,939] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=2, name=AdaptiveMarginHingeLoss: reason=missing_dependency: name 'softplus' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:16:31,381] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:16:43,399] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:16:54,407] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:16:54,432] WARNING:ptp_discovery.free_loss_eoh: Preference gates failed for gen=1, idx=2, name=AdaptiveLogSigmoidWithSoftMargin: reason=pref_semantic_violation; attempting repair (attempt=2/2)
[2025-12-21 19:17:05,382] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:17:14,483] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:17:14,494] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=3, name=AdaptiveCostGapMarginLogSigmoid: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:17:23,487] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:17:23,497] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=3, name=AdaptiveCostGapMarginLogSigmoid: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:17:35,479] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:17:35,491] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=4, name=AdaptiveSigmoidFocalLoss: reason=missing_dependency: name 'tanh' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:17:49,060] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:18:00,707] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:18:11,669] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:18:11,683] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=4, name=SigmoidScaledAdaptiveMarginLoss: reason=missing_batch_key: 'ops', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:18:22,473] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:18:22,487] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=4, name=SigmoidScaledAdaptiveMarginLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'ops', and 'hyperparams', loss_value=None, grad_norm=None
[2025-12-21 19:18:33,593] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:18:33,606] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=5, name=AsymmetricFocalLoss: reason=missing_dependency: name 'tanh' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:18:49,435] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:19:02,154] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:19:12,564] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:19:12,573] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=5, name=AdaptiveCostRankLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:19:24,670] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:19:24,682] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=5, name=AdaptiveCostRankLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:19:35,409] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:19:35,421] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=6, name=AdaptiveFocalLogSigmoidLoss: reason=forward_error: generated_loss() missing 5 required positional arguments: 'log_prob_l', 'hyperparams', 'F', 'torch', and 'weights', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:19:46,253] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:19:56,460] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:19:56,474] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=1, idx=7, name=AdaptiveTanhMarginLogSigmoid: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:20:06,661] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:20:06,666] INFO:ptp_discovery.free_loss_eoh: Generation 1 summary: static_fail=0, dynamic_fail=5, evaluated=0, new_elites=0
[2025-12-21 19:20:06,666] INFO:ptp_discovery.free_loss_eoh: === Generation 2/9 ===
[2025-12-21 19:20:06,666] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=0
[2025-12-21 19:20:21,359] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:20:33,526] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:20:47,784] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:20:59,315] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:21:14,472] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:21:26,188] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:21:41,535] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:21:53,246] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:22:08,892] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:22:20,197] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:22:35,732] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:22:47,706] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:23:01,965] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:23:13,069] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:23:27,195] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:23:38,741] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:23:38,744] INFO:ptp_discovery.free_loss_eoh: Population size for generation 2: 8
[2025-12-21 19:23:49,775] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:23:49,791] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=0, name=AdaptiveMarginHingeLoss: reason=missing_dependency: name 'max' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:24:04,781] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:24:16,432] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:24:27,833] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:24:27,845] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=0, name=Adaptive Margin Log-Ratio Loss: reason=missing_batch_key: 'ops', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:24:40,551] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:24:40,562] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=0, name=Adaptive Margin Log-Ratio Loss: reason=forward_error: generated_loss() missing 4 required positional arguments: 'log_prob_l', 'hyperparams', 'operators', and 'batch', loss_value=None, grad_norm=None
[2025-12-21 19:24:51,516] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:24:51,543] WARNING:ptp_discovery.free_loss_eoh: Preference gates failed for gen=2, idx=1, name=AdaptiveMarginHingeLoss: reason=pref_semantic_violation; attempting repair (attempt=2/2)
[2025-12-21 19:25:02,043] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:25:13,051] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:25:13,093] WARNING:ptp_discovery.free_loss_eoh: Preference gates failed for gen=2, idx=2, name=AdaptiveTanhMarginLoss: reason=pref_semantic_violation; attempting repair (attempt=2/2)
[2025-12-21 19:25:24,316] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:25:36,404] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:25:36,418] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=3, name=AdaptiveMarginHingeLoss: reason=missing_dependency: name 'rank_gap' is not defined; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:25:51,584] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:26:03,232] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:26:14,263] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:26:14,271] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=3, name=AdaptiveSigmoidFocalLoss: reason=missing_dependency: name 'logsigmoid' is not defined, loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:26:26,345] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:26:38,563] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:26:38,578] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=4, name=AdaptiveHingeLogBarrierLoss: reason=missing_batch_key: 'zscore'; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:26:52,104] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:27:02,283] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:27:11,799] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:27:21,849] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:27:21,864] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=4, name=AdaptiveTanhMarginLogSigmoid: reason=missing_batch_key: 'log_prob_w', loss_value=None, grad_norm=None
[2025-12-21 19:27:31,282] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:27:31,293] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=5, name=AdaptiveHingeLogSigmoid: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:27:41,541] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:27:41,552] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=5, name=AdaptiveHingeLogSigmoid: reason=forward_error: generated_loss() missing 4 required positional arguments: 'log_prob_l', 'hyperparams', 'operators', and 'rank_gap', loss_value=None, grad_norm=None
[2025-12-21 19:27:52,117] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:28:02,185] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:28:12,659] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:28:12,672] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=7, name=AdaptiveTanhMarginLogSigmoid: reason=missing_batch_key: 'operators'; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:28:26,830] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:28:37,796] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:28:46,635] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:28:46,647] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=7, name=AdaptiveHingeLogLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'log_prob_l' and 'hyperparams', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:28:55,614] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:28:55,629] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=2, idx=7, name=AdaptiveHingeLogLoss: reason=forward_error: generated_loss() missing 2 required positional arguments: 'rejected_costs' and 'hyperparams', loss_value=None, grad_norm=None
[free_loss_eoh][device_worker] pid=3105 device=cuda:0 jobs=[(2, 6)]
[2025-12-21 19:30:13,440] INFO:ptp_discovery.free_loss_eoh: Gen 2 cand 6: hf_like_score=33.541276, validation_objective=23.534540, epoch_mean=nan, epoch_violations=10, baseline=7.942243, better_than_baseline=False
[2025-12-21 19:30:13,440] INFO:ptp_discovery.free_loss_eoh: Generation 2 summary: static_fail=0, dynamic_fail=4, evaluated=1, new_elites=1
[2025-12-21 19:30:13,440] INFO:ptp_discovery.free_loss_eoh: === Generation 3/9 ===
[2025-12-21 19:30:13,440] INFO:ptp_discovery.free_loss_eoh: Generating population via crossover/mutation: size=8, elite_size=4, available_elites=1
[2025-12-21 19:30:26,379] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:30:37,102] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:30:50,840] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:31:02,153] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:31:14,419] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:31:24,525] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:31:39,590] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:31:51,709] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:32:05,242] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:32:17,015] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:32:29,529] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:32:40,496] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:32:53,997] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:33:05,065] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:33:18,417] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:33:29,020] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:33:29,023] INFO:ptp_discovery.free_loss_eoh: Population size for generation 3: 8
[2025-12-21 19:33:29,058] WARNING:ptp_discovery.free_loss_eoh: Preference gates failed for gen=3, idx=0, name=AdaptiveSigmoidMarginLogSigmoid: reason=pref_semantic_violation; attempting repair (attempt=1/2)
[2025-12-21 19:33:41,589] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:33:41,624] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=1, name=NormalizedCostGapMargin: reason=missing_batch_key: 'operators'; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:33:54,462] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:34:05,067] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:34:05,081] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=1, name=CostGapNormalizedLogSigmoidLoss: reason=missing_batch_key: 'operators', loss_value=None, grad_norm=None; attempting repair (attempt=1/2)
[2025-12-21 19:34:15,093] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:34:25,505] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:34:25,518] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=1, name=CostGapNormalizedLogSigmoidLoss: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:34:35,951] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:34:45,412] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:34:45,425] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=2, name=AdaptiveSoftplusMarginLogSigmoid: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:34:45,441] WARNING:ptp_discovery.free_loss_eoh: Preference gates failed for gen=3, idx=3, name=SigmoidScaledLogSigmoid: reason=pref_semantic_violation; attempting repair (attempt=1/2)
[2025-12-21 19:34:57,564] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:35:07,464] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:35:07,477] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=3, name=SigmoidScaledLogSigmoid: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:35:07,483] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=4, name=NormalizedCostGapMarginLogSigmoid: reason=forward_error: 'NoneType' object is not callable, loss_value=None, grad_norm=None; attempting repair (attempt=1/2)
[2025-12-21 19:35:19,322] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:35:31,930] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:35:31,946] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=4, name=NormalizedCostGapMarginLogSigmoid: reason=missing_batch_key: 'operators'; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:35:45,011] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:35:55,294] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:35:55,308] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=4, name=NormalizedCostGapMarginLogSigmoid: reason=missing_batch_key: 'zscore', loss_value=None, grad_norm=None; attempting repair (attempt=1/2)
[2025-12-21 19:36:04,954] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:36:04,973] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=4, name=NormalizedCostGapMarginLogSigmoid: reason=missing_batch_key: 'zscore', loss_value=None, grad_norm=None; attempting repair (attempt=2/2)
[2025-12-21 19:36:14,448] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:36:25,294] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:36:36,042] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:36:36,060] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=5, name=AdaptiveSigmoidMarginLossV2: reason=forward_error: generated_loss() missing 3 required positional arguments: 'log_prob_l', 'hyperparams', and 'operators', loss_value=None, grad_norm=None
[2025-12-21 19:36:36,064] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=6, name=NormalizedCostGapLogSigmoid: reason=missing_batch_key: 'zscore'; dropping candidate and resampling (attempt=1/1)
[2025-12-21 19:36:48,793] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:37:00,007] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-12-21 19:37:00,019] WARNING:ptp_discovery.free_loss_eoh: Dynamic gates failed for gen=3, idx=6, name=NormalizedCostGapMargin: reason=forward_error: 'NoneType' object is not callable, loss_value=None, grad_norm=None; attempting repair (attempt=1/2)
[2025-12-21 19:37:11,144] INFO:httpx: HTTP Request: POST https://api.bltcy.ai/v1/chat/completions "HTTP/1.1 200 OK"
Traceback (most recent call last):
  File "/data1/gushengda/PTP/ptp_discovery/run_free_loss_eoh.py", line 57, in <module>
    main()
  File "/data1/gushengda/PTP/ptp_discovery/run_free_loss_eoh.py", line 53, in main
    run_free_loss_eoh(args.config, **overrides)
  File "/data1/gushengda/PTP/ptp_discovery/free_loss_eoh_loop.py", line 1409, in run_free_loss_eoh
    dyn_res = run_dynamic_gates(
              ^^^^^^^^^^^^^^^^^^
  File "/data1/gushengda/PTP/ptp_discovery/free_loss_gates.py", line 151, in run_dynamic_gates
    if not torch.isfinite(loss):
           ^^^^^^^^^^^^^^^^^^^^
TypeError: isfinite(): argument 'input' (position 1) must be Tensor, not float
